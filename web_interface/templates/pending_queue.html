{% extends "base.html" %}

{% block title %}Pending Queue - Claude Code Job Queue{% endblock %}

{% block content %}
<div class="card">
    <h2>Pending Jobs Requiring Approval</h2>

    {% if jobs %}
        <p style="margin-bottom: 1rem; color: #856404; background: #fff3cd; padding: 1rem; border-radius: 4px;">
            <strong>{{ jobs|length }}</strong> job(s) waiting for approval. Review and approve jobs to add them to the processing queue.
        </p>

        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Type</th>
                    <th>Created</th>
                    <th>User</th>
                    <th>Priority</th>
                    <th>Preview</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for job in jobs %}
                <tr>
                    <td>#{{ job.id }}</td>
                    <td>{{ job.job_type }}</td>
                    <td>{{ job.created_at|datetime }}</td>
                    <td>{{ job.username }}</td>
                    <td>{{ job.priority }}</td>
                    <td>
                        {% if job.prompt %}
                            <div style="max-width: 300px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                                {{ job.prompt[:100] }}{% if job.prompt|length > 100 %}...{% endif %}
                            </div>
                        {% endif %}
                        {% if job.file_paths %}
                            <small style="color: #7f8c8d;">{{ job.file_paths|length }} file(s)</small>
                        {% endif %}
                    </td>
                    <td>
                        <a href="{{ url_for('view_job', job_id=job.id) }}" class="btn btn-small">Review</a>
                        <form method="POST" action="{{ url_for('approve_job', job_id=job.id) }}" style="display: inline; margin-left: 0.5rem;">
                            <button type="submit" class="btn btn-small btn-success">Quick Approve</button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p style="color: #28a745; background: #d4edda; padding: 1rem; border-radius: 4px;">
            No jobs pending approval. All jobs have been reviewed!
        </p>
    {% endif %}
</div>

<div class="card">
    <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">Back to Dashboard</a>
</div>
{% endblock %}
